{% extends "base.html" %}

{% block title %}Special One - Love & Romance{% endblock %}

{% block content %}
<div class="page-container gallery-page">
    <div class="gallery-header">
        <h1 class="special-title">Special one</h1>
    </div>
    
    <div class="photo-gallery">
        {% for photo in photos %}
        <div class="photo-slide {% if loop.first %}active{% endif %}" data-photo="{{ loop.index0 }}">
            <div class="photo-background" style="background-image: url('{{ photo.image }}')"></div>
            <div class="photo-overlay"></div>
            
            <div class="photo-info">
                <h2 class="photo-title">{{ photo.title }}</h2>
                <p class="photo-description">{{ photo.description }}</p>
            </div>
        </div>
        {% endfor %}
    </div>
    
    <div class="gallery-navigation">
        <button class="nav-btn prev-btn" onclick="changePhoto(-1)">
            <i class="fas fa-chevron-left"></i>
        </button>
        <div class="photo-indicators">
            {% for photo in photos %}
            <span class="indicator {% if loop.first %}active{% endif %}" onclick="goToPhoto({{ loop.index0 }})"></span>
            {% endfor %}
        </div>
        <button class="nav-btn next-btn" onclick="changePhoto(1)">
            <i class="fas fa-chevron-right"></i>
        </button>
    </div>
    
    <div class="gallery-actions">
        <button class="continue-btn" onclick="window.location.href='{{ url_for('proposal') }}'">
            Continue Journey
            <i class="fas fa-arrow-right"></i>
        </button>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
let currentPhoto = 0;
const totalPhotos = {{ photos|length }};

function changePhoto(direction) {
    const slides = document.querySelectorAll('.photo-slide');
    const indicators = document.querySelectorAll('.indicator');
    
    // Remove active class from current photo
    slides[currentPhoto].classList.remove('active');
    indicators[currentPhoto].classList.remove('active');
    
    // Calculate new photo index
    currentPhoto += direction;
    if (currentPhoto >= totalPhotos) currentPhoto = 0;
    if (currentPhoto < 0) currentPhoto = totalPhotos - 1;
    
    // Add active class to new photo
    slides[currentPhoto].classList.add('active');
    indicators[currentPhoto].classList.add('active');
}

function goToPhoto(index) {
    const slides = document.querySelectorAll('.photo-slide');
    const indicators = document.querySelectorAll('.indicator');
    
    slides[currentPhoto].classList.remove('active');
    indicators[currentPhoto].classList.remove('active');
    
    currentPhoto = index;
    
    slides[currentPhoto].classList.add('active');
    indicators[currentPhoto].classList.add('active');
}

// Touch/swipe support for mobile
let startX = 0;
let startY = 0;

document.addEventListener('touchstart', function(e) {
    startX = e.touches[0].clientX;
    startY = e.touches[0].clientY;
});

document.addEventListener('touchend', function(e) {
    if (!startX || !startY) return;
    
    const endX = e.changedTouches[0].clientX;
    const endY = e.changedTouches[0].clientY;
    
    const diffX = startX - endX;
    const diffY = startY - endY;
    
    // Only trigger if horizontal swipe is more significant than vertical
    if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {
        if (diffX > 0) {
            changePhoto(1); // Swipe left - next photo
        } else {
            changePhoto(-1); // Swipe right - previous photo
        }
    }
    
    startX = 0;
    startY = 0;
});

// Auto-advance photos every 5 seconds
setInterval(() => {
    changePhoto(1);
}, 5000);
</script>
{% endblock %}
